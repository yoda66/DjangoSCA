#################################################
## TangoCheck Parser Configuration Rules File  ##
## Author: Joff Thyer (c) 2013                 ##
#################################################

##----------------------------------------------------------------------+
## Rules beginning with 'settings_' are used by the SettingCheck class
##----------------------------------------------------------------------+

# settings.py: Required Fields
# if any of the variable fields below are missing, then print a warning
"settings_req_field","ADMINS"
"settings_req_field","ALLOWED_HOSTS"
"settings_req_field","DEBUG"
"settings_req_field","INSTALLED_APPS"
"settings_req_field","MANAGERS"
"settings_req_field","MIDDLEWARE_CLASSES"
"settings_req_field","PASSWORD_HASHERS"
"settings_req_field","TEMPLATE_DEBUG"

# settings.py: Recommended Variable Settings
# if any of the variables below are not set to the recommended value,
# then print a warning
"settings_rec_var","DEBUG","False"
"settings_rec_var","SESSION_COOKIE_SECURE","True"
"settings_rec_var","SESSION_COOKIE_HTTP_ONLY","True"
"settings_rec_var","TEMPLATE_DEBUG","False"

# settings.py: Recommended Middleware
# print a warning if the MIDDLEWARE_CLASSES variable does not include these
"settings_rec_middleware","django.contrib.sessions.middleware.SessionMiddleware"
"settings_rec_middleware","django.middleware.csrf.CsrfViewMiddleware"

# settings.py: Recommended Installed Apps
# display these as recommended if they are not include in the
# INSTALLED_APPS variable
"settings_rec_apps","django_bleach","https://github.com/jsocol/bleach"


##----------------------------------------------------------------+
## Rules below are being used by the MyParser.py class.    
##----------------------------------------------------------------+

# source code import module checks
"import","^import Pickle","%OWASP-CR-APIUsage: import Pickle"
"import","^import cPickle","%OWASP-CR-APIUsage: import cPickle"
"import","^from django.utils.safestring import mark_safe","%OWASP-CR-APIUsage: import mark_safe"

# source code string variable checks
"string",".*(SELECT|select).+(FROM|from).+(WHERE|where).*","%OWASP-CR-APIUsage: SQL SELECT query found"
"string",".*(INSERT|insert)\s{1,}(INTO|into).+(VALUES|values)\s{1,}\(.+\).*","%OWASP-CR-APIUsage: SQL INSERT query found"
"string",".*(DELETE|delete)\s{1,}(FROM|from).+(WHERE|where).*","%OWASP-CR-APIUsage: SQL DELETE query found"

# source code general regular expression searches
"general","@csrf_exempt$|.+csrf_exempt\s{1,}=\s{1,}True.+","%OWASP-CR-InputValidation: csrf_exempt"
"general",".*mark_safe\(.+\).*","%OWASP-CR-ResourceUsage: mark_safe() function call"
"general",".*os\.system\(.+\).*","%OWASP-CR-ResourceUsage: os.system() function call"
"general",".*random\.random\(\).*","%OWASP-CR-ResourceUsage: random.random() function call"
"general",".*subprocess\.(call|check).*","%OWASP-CR-ResourceUsage: subprocess.call()|check() function call"

# template file regular expression searches
"template",".+\|safe.+","%OWASP-CR-APIUsage: { |safe } variable"
"template",".+autoescape\s{1,}off.+","%OWASP-CR-APIUsage: {% autoescape off %}"

#################
## End of File ##
#################
